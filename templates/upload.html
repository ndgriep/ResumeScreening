<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Resume Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        async function submitForm(event) {
            event.preventDefault();

            const form = document.getElementById("upload-form");
            const formData = new FormData(form);

            const response = await fetch("/analyze/", {
                method: "POST",
                body: formData
            });

            const result = await response.json();
            const resultContainer = document.getElementById("result");

            if (result.error) {
                resultContainer.innerHTML = `
                    <div class="p-4 bg-red-100 text-red-700 rounded">
                        <p class="font-bold">Error:</p>
                        <p>${result.error}</p>
                        <pre class="mt-2 text-xs">${result.raw || ''}</pre>
                    </div>`;
                return;
            }

            resultContainer.innerHTML = `
                <div class="p-4 bg-green-100 text-green-900 rounded shadow">
                    <p class="text-lg font-bold">Match Score: ${result.match_score}/100</p>
                    <p class="italic mt-1">${result.summary}</p>

                    <div class="mt-3">
                        <h3 class="font-semibold">Strengths:</h3>
                        <ul class="list-disc ml-6">
                            ${result.strengths.map(s => `<li>${s}</li>`).join("")}
                        </ul>
                    </div>

                    <div class="mt-3">
                        <h3 class="font-semibold">Areas for Improvement:</h3>
                        <ul class="list-disc ml-6">
                            ${result.weaknesses.map(w => `<li>${w}</li>`).join("")}
                        </ul>
                    </div>

                    <div class="mt-3">
                        <h3 class="font-semibold">Missing Skills:</h3>
                        <ul class="list-disc ml-6">
                            ${result.missing_skills.map(m => `<li>${m}</li>`).join("")}
                        </ul>
                    </div>

                    <div class="mt-3">
                        <h3 class="font-semibold">Recommendations:</h3>
                        <ul class="list-disc ml-6">
                            ${result.recommendations.map(r => `<li>${r}</li>`).join("")}
                        </ul>
                    </div>
                </div>
            `;
        }
    </script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-2xl">
        <h1 class="text-2xl font-bold mb-6 text-center">Resume Analyzer</h1>
        <form id="upload-form" onsubmit="submitForm(event)" enctype="multipart/form-data" class="space-y-4">
            <div>
                <label class="block font-medium">Upload Resume:</label>
                <input type="file" name="resume" required accept=".txt,.pdf,.docx"
                       class="w-full mt-1 border rounded p-2" />
            </div>
            <div>
                <label class="block font-medium">Upload Job Description:</label>
                <input type="file" name="job_description" required accept=".txt,.pdf,.docx"
                       class="w-full mt-1 border rounded p-2" />
            </div>
            <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                Analyze Resume
            </button>
        </form>

        <div id="result" class="mt-6"></div>
    </div>
</body>
</html>
